#include "main.h"

//Fonction qui renvoie le nombre de chansons dans le fichier BPM :
int compter_tracks (FILE *bpm)
{
    int nb_tracks = 0 ;
    char stok = ' ' ;
    rewind (bpm) ;
    while ((stok = getc (bpm)) != EOF)
        {
            if (stok == '\n')
                {
                    nb_tracks++ ;
                }
        }
    return nb_tracks ;
}

//Fonction qui écrit les tags d'un chanson dans le .csv :
void ecrire_tags (FILE *liste, FILE *bpm)
{
    int n_bpm = 0 ;
    float f_bpm = 0.0 ;
    char titre[1000], artiste[1000] ;

    rewind (bpm) ;
    avancer_fichier(bpm) ; //On fait avancer le curseur virtuel jusqu'à avoir passer le chemin.
    fscanf (bpm, "%s %s %f\n", titre, artiste, &f_bpm) ; //On scanne les données.
    arrondir (&f_bpm, 0) ; //On arrondit les BPM.
    n_bpm = (int) f_bpm ;
    fprintf (liste, "%s, %s, %d\n", artiste, titre, n_bpm) ; //On écrit le tout dans le fichier .csv.
}

//Fonction qui arrondit un float :
void arrondir (float *mise, int precision)
{
    float test = pow (10, precision) * *mise ;
    if (test - (int) test >= 0.5)
        {
            *mise = ( (int) test + 1) / pow (10, precision) ;
        }
    else
        {
            *mise = ( (int) test) / pow (10, precision) ;
        }
}

//Fonction qui fait avancer le curseur jusqu'après le chemin (après le ".mp3" :
void avancer_fichier(FILE *fichier)
{
    int i ;
    char sto
}
